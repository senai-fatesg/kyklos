<?xml version="1.0" encoding="utf-8" ?>
<ui:composition template="template.xhtml"
	xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:a="http://www.ambientinformatica.com.br/jsf2"
	xmlns:p="http://primefaces.org/ui">
	<link href="css/estilo.css" rel="stylesheet" type="text/css" />

	<ui:define name="cabecalho">
		<style>
.ui-autocomplete-input {
	width: 170px !important;
}
</style>
	</ui:define>

	<ui:define name="corpo">

		<h:form id="frm">

			<p:messages id="msgs" />


			<p:toolbar id="toolbar">
				
					<p:toolbarGroup align="left">

						<p:commandButton value="Novo" icon="ui-icon-document"
							action="#{unidadeTableControl.prepararNovoCadastro}"
							process="@this" update="unidade-dialog"
							oncomplete="PF('edicaoUnidadeDialog').show()">
							<p:resetInput target="unidade-dialog" />

						</p:commandButton>
						<p:commandButton value="Consultar" icon="ui-icon-document"
							action="#{unidadeTableControl.consultar}" process="@this"
							update="@all">
						</p:commandButton>

						<span class="ui-separator"> <span
							class="ui-icon ui-icon-grip-dotted-vertical" />
						</span>

						<p:commandButton icon="ui-icon-pencil" title="Editar"
							process="@this" update="unidade-dialog"
							oncomplete="PF('edicaoUnidadeDialog').show()">
							<p:resetInput target="unidade-dialog" />

							<f:setPropertyActionListener
								value="#{unidadeTableControl.unidadeSelecionada}"
								target="#{unidadeTableControl.unidadeEdicao}" />
						</p:commandButton>

						<p:commandButton icon="ui-icon-trash" title="Excluir"
							process="@this" update="unidade-table msgs toolbar"
							action="#{unidadeTableControl.excluir}"
							disabled="#{unidadeTableControl.unidadeSelecionada == null}">

							<p:confirm icon="ui-icon-alert" header="Confirmação de exclusão"
								message="Tem certeza que deseja excluir essa unidade?" />
						</p:commandButton>

					</p:toolbarGroup>
					<p:toolbarGroup align="right">
						
						<p:inputText value="#{unidadeTableControl.sigla}" />
						
						<p:commandButton icon="ui-icon-search"/>
					</p:toolbarGroup>




			</p:toolbar>


			<p:panel header="Buscar / Filtros" toggleable="true" id="filtrosjs"
				widgetVar="filtrosjs" toggleOrientation="vertical"
				icon="ui-icon-search">

				<p:panelGrid styleClass="semBorda" style="width:100%;">
					<p:row>
						<p:column style="text-align: right; width:60%">
							<p:inputText id="textBox" style="text-transform:uppercase"
								size="10" class="searchBar" placeholder="Unidade (sigla)"
								update="textBox unidades-table"
								value="#{unidadeTableControl.sigla}" />
						</p:column>
						<p:column style="text-align:left;">
							<p:commandButton class="listaButton"
								actionListener="#{unidadeTableControl.consultar}" ajax="false"
								value="" icon="ui-icon-search" update="@all" />
						</p:column>
					</p:row>

				</p:panelGrid>
			</p:panel>


			<p:dataTable id="unidade-table"
				value="#{unidadeTableControl.todasUnidades}" var="unidade"
				emptyMessage="Nenhuma unidade cadastrada." rows="10"
				paginator="true" paginatorPosition="bottom" style="margin-top: 10px"
				selection="#{unidadeTableControl.unidadeSelecionada}"
				selectionMode="single" rowKey="#{unidade.id}">




				<p:column headerText="Descrição" sortBy="#{unidade.descricao}">
					<h:outputText value="#{unidade.descricao}" />
				</p:column>
				<p:column headerText="Sigla" width="250">
					<h:outputText value="#{unidade.sigla}" />
				</p:column>
			</p:dataTable>

			<p:dialog header="Nova Unidade" widgetVar="edicaoUnidadeDialog"
				id="unidade-dialog" resizable="false" closeOnEscape="true"
				modal="true">

				<p:messages id="msgs-dialog" />
				<p:defaultCommand target="salvar-button" scope="unidade-dialog" />

				<h:panelGrid columns="2" id="painel-dialog">
					<p:outputLabel value="Descrição" for="descricao" />
					<p:inputText id="descricao" style="text-transform:uppercase"
						size="60" maxlength="80"
						value="#{unidadeTableControl.unidadeEdicao.descricao}" />

					<p:outputLabel value="Sigla" for="sigla" />
					<p:inputText id="sigla" size="18" maxlength="11"
						value="#{unidadeTableControl.unidadeEdicao.sigla}" />

					<p:commandButton value="Salvar" id="salvar-button"
						action="#{unidadeTableControl.salvar}" process="unidade-dialog"
						update="msgs-dialog painel-dialog"
						oncomplete="if (!args.validationFailed) PF('edicaoUnidadeDialog').hide()" />
				</h:panelGrid>
			</p:dialog>


		</h:form>
	</ui:define>
</ui:composition>