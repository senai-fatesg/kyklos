<?xml version='1.0' encoding='utf-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
                      "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:h="http://java.sun.com/jsf/html" xmlns:f="http://java.sun.com/jsf/core" xmlns:ui="http://java.sun.com/jsf/facelets" xmlns:p="http://primefaces.org/ui"
   xmlns:a="http://www.ambientinformatica.com.br/jsf2">
<h:head>
   <link href="css/estilo.css" rel="stylesheet" type="text/css" />
   <link href="css/kyklos.css" rel="stylesheet" type="text/css" />
   <ui:insert name="cabecalho" />
</h:head>
<h:body>

   <h:form id="formCorpo">

      <div id="mainStruct">

         <div id="header">

            <div id="headerLeft">
               <font face="Arial Narrow"> Empresa: </font>
               <a:newLine />
               <p:autoComplete id="empresa" size="20" dropdown="true" rendered="#{usuarioLogadoControl.variasEmpresas}" converter="objectConverter" value="#{usuarioLogadoControl.empresaUsuario}"
                  var="e" itemValue="#{e}" itemLabel="#{e.empresa.nome}" completeMethod="#{usuarioLogadoControl.completeEmpresa}">
                  <p:ajax event="itemSelect" update="@all" />
               </p:autoComplete>
               <h:outputText value="#{usuarioLogadoControl.empresaUsuario.empresa.pessoa.nome}" rendered="#{!usuarioLogadoControl.variasEmpresas}" style="height: 30px; width: 100px;" />
            </div>

            <div id="headerRight">
               <font face="Arial Narrow">Usuário: #{usuarioLogadoControl.usuario.nome}</font>
               <a:newLine />
               <p:commandButton type="button" value="Redefinir Senha" action="#{usuarioLogadoControl.limparSenhas}" onclick="PF('dialogChangePassword').show();" icon="ui-icon-key" />
               <p:commandButton type="button" value="Meu Cadastro" onclick="PF('dialogMeuCadastro').show();" icon="ui-icon-person" />
               <p:commandButton type="button" value="Sair" onclick="PF('confirmDialog').show();" icon="ui-icon-extlink" />

               <p:confirmDialog header="Confirmação" message="Tem certeza que deseja sair?" severity="alert" widgetVar="confirmDialog" resizable="false">

                  <p:commandButton value="Sim" actionListener="document.location.href='sair.jsp';" onclick="document.location.href='sair.jsp';" styleClass="ui-confirmdialog-yes" icon="ui-icon-check" />

                  <p:commandButton value="Não" onclick="PF('confirmDialog').hide()" type="button" styleClass="ui-confirmdialog-no" icon="ui-icon-close" />

               </p:confirmDialog>
            </div>

         </div>

         <div id="sidebar">

            <div id="sidebarLogo"></div>

            <div id="sidebarMenu">
               <div id='cssmenu'>
                  <ul>
                     <li><a href='./inicio.xhtml'><span>Início</span></a></li>
                     <li class='active has-sub'><a href='#'><span>Pedidos</span></a>
                        <ul>
                           <li class='last'><a href='./pedido.xhtml'> <span>Novo Pedido</span></a></li>
                           <li class='last'><a href='./pedidoLista.xhtml'> <span>Consultar Pedido</span></a></li>
                           <li class='last'><a href='./importarPedido.xhtml'> <span>Importar Pedido</span></a></li>
                        </ul></li>
                     <li class='active has-sub'><a href='#'><span>Cadastro</span></a>
                        <ul>
                           <li class='last'><a href='./pessoa.xhtml'>Pessoa</a></li>
                           <li class='last'><a href='./produto.xhtml'>Produto</a></li>
                           <li class='last'><a href='./estoque.xhtml'>Estoque</a></li>
                           <li class='last'><a href='./transportadora.xhtml'>Transportadora</a></li>
                        </ul></li>
                     <li class='active has-sub'><a href='#'><span>Administrar</span></a>
                        <ul>
                           <li class='last'><a href='./usuario.xhtml'>Usuário</a></li>
                        </ul></li>
                  </ul>
               </div>
            </div>

            <div id="sidebarBottom">
               <font id="sidebotText" size="1" face="Arial Narrow" color="#FFFFFF"> © Ambient Informática </font>
            </div>

         </div>

         <div id="content">
            <p:messages autoUpdate="true" />
            <ui:insert name="corpo" />
            <p:dialog header="Meu Cadastro" widgetVar="dialogMeuCadastro" id="dialogMeuCadastro" showEffect="puff" hideEffect="scale" resizable="false">
               <p:panelGrid id="meuCadastroGrid" styleClass="semBorda">
                  <p:row>
                     <p:column colspan="2">
                        <p:outputLabel value="Usuário: " style="font-weight:bold;" />
                        <h:outputText value="#{usuarioLogadoControl.usuario.login}" />
                     </p:column>
                  </p:row>
                  <p:row>
                     <p:column colspan="2">
                        <p:outputLabel value="Nome: " style="font-weight:bold;" />
                        <p:inputText value="#{usuarioLogadoControl.usuario.nome}" />
                     </p:column>
                  </p:row>
                  <p:row>
                     <p:column>
                        <p:outputLabel value="Data de Cadastro" style="font-weight:bold;" />
                        <a:newLine />
                        <p:outputLabel value="#{usuarioLogadoControl.usuario.dataCriacao}">
                           <f:convertDateTime pattern="dd/MM/yyyy" />
                        </p:outputLabel>
                     </p:column>

                     <p:column>
                        <p:outputLabel value="Último Acesso" style="font-weight:bold;" />
                        <a:newLine />
                        <p:outputLabel value="#{usuarioLogadoControl.usuario.dataUltimoAcesso}">
                           <f:convertDateTime pattern="dd/MM/yyyy" />
                        </p:outputLabel>
                     </p:column>
                  </p:row>
                  <p:row>
                     <p:column>
                        <p:commandButton value="Cancelar" onclick="PF('dialogMeuCadastro').hide();" />
                     </p:column>
                     <p:column colspan="2" styleClass="c">
                        <p:commandButton value="Alterar" actionListener="#{usuarioLogadoControl.alterar}" />
                     </p:column>
                  </p:row>
               </p:panelGrid>

            </p:dialog>

            <p:dialog header="Redefinir Senha" widgetVar="dialogChangePassword" id="dialogChangePassword" showEffect="puff" hideEffect="scale" resizable="false">
               <p:panelGrid id="changePasswordGrid" styleClass="semBorda">
                  <p:row>
                     <p:column colspan="2">
                        <p:outputLabel value="Digite sua senha atual" style="font-weight:bold;" />
                        <a:newLine />
                        <p:password value="#{usuarioLogadoControl.senhaAtual}" style="width: 220px;" />
                     </p:column>
                  </p:row>
                  <p:row>
                     <p:column colspan="2">
                        <p:outputLabel value="Digite sua nova senha" style="font-weight:bold;" />
                        <a:newLine />
                        <p:password value="#{usuarioLogadoControl.novaSenha}" style="width: 220px;" />
                     </p:column>
                  </p:row>
                  <p:row>
                     <p:column colspan="2">
                        <p:outputLabel value="Confirme sua nova senha" style="font-weight:bold;" />
                        <a:newLine />
                        <p:password value="#{usuarioLogadoControl.confirmacaoNovaSenha}" style="width: 220px;" />
                     </p:column>
                  </p:row>
                  <p:row>
                     <p:column colspan="2" styleClass="c">
                        <a:newLine />
                        <p:commandButton value="Confirmar" actionListener="#{usuarioLogadoControl.alterarSenha}" onsuccess="PF('dialogChangePassword').hide();" />
                     </p:column>
                  </p:row>
               </p:panelGrid>
            </p:dialog>
         </div>
      </div>
   </h:form>
</h:body>
</html>
